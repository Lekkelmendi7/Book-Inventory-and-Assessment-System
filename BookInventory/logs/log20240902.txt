2024-09-02 09:32:19.803 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-09-02 09:32:19.918 +02:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-09-02 09:32:19.921 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-09-02 09:32:19.922 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-09-02 09:32:20.028 +02:00 [INF] Executed DbCommand (83ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2024-09-02 09:32:20.065 +02:00 [INF] Applying migration '20240902073202_Ratingss'.
2024-09-02 09:32:20.228 +02:00 [INF] Executed DbCommand (91ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Ratings] (
    [Id] int NOT NULL IDENTITY,
    [Rate] int NOT NULL,
    [BookId] int NOT NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_Ratings] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Ratings_Books_BookId] FOREIGN KEY ([BookId]) REFERENCES [Books] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Ratings_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2024-09-02 09:32:20.249 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Ratings_BookId] ON [Ratings] ([BookId]);
2024-09-02 09:32:20.252 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Ratings_UserId] ON [Ratings] ([UserId]);
2024-09-02 09:32:20.275 +02:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20240902073202_Ratingss', N'8.0.8');
2024-09-02 11:45:02.055 +02:00 [INF] User profile is available. Using 'C:\Users\lkelmendi.PC-PR05\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-02 11:45:02.601 +02:00 [INF] Now listening on: https://localhost:7126
2024-09-02 11:45:02.603 +02:00 [INF] Now listening on: http://localhost:5019
2024-09-02 11:45:02.605 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-02 11:45:02.607 +02:00 [INF] Hosting environment: Development
2024-09-02 11:45:02.608 +02:00 [INF] Content root path: C:\Users\lkelmendi.PC-PR05\Desktop\BookInventory\BookInventory
2024-09-02 11:45:05.782 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.html - null null
2024-09-02 11:45:06.221 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.html - 200 null text/html;charset=utf-8 446.746ms
2024-09-02 11:45:06.223 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - null null
2024-09-02 11:45:06.224 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.css - null null
2024-09-02 11:45:06.224 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/swagger-ui.css - null null
2024-09-02 11:45:06.232 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/swagger-ui-standalone-preset.js - null null
2024-09-02 11:45:06.248 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/swagger-ui-bundle.js - null null
2024-09-02 11:45:06.249 +02:00 [INF] The file /swagger-ui-standalone-preset.js was not modified
2024-09-02 11:45:06.249 +02:00 [INF] The file /index.css was not modified
2024-09-02 11:45:06.249 +02:00 [INF] The file /swagger-ui.css was not modified
2024-09-02 11:45:06.251 +02:00 [INF] The file /swagger-ui-bundle.js was not modified
2024-09-02 11:45:06.252 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/swagger-ui-standalone-preset.js - 304 null text/javascript 19.5865ms
2024-09-02 11:45:06.252 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.css - 304 null text/css 27.5905ms
2024-09-02 11:45:06.253 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/swagger-ui.css - 304 null text/css 28.4585ms
2024-09-02 11:45:06.254 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/swagger-ui-bundle.js - 304 null text/javascript 5.6272ms
2024-09-02 11:45:06.256 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.js - null null
2024-09-02 11:45:06.265 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 41.6347ms
2024-09-02 11:45:06.273 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.js - 200 null application/javascript;charset=utf-8 16.4921ms
2024-09-02 11:45:06.284 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_vs/browserLink - null null
2024-09-02 11:45:06.420 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_vs/browserLink - 200 null text/javascript; charset=UTF-8 136.7365ms
2024-09-02 11:45:06.581 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - null null
2024-09-02 11:45:06.849 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 268.8784ms
2024-09-02 14:22:01.975 +02:00 [INF] User profile is available. Using 'C:\Users\lkelmendi.PC-PR05\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-02 14:22:02.417 +02:00 [INF] Now listening on: https://localhost:7126
2024-09-02 14:22:02.418 +02:00 [INF] Now listening on: http://localhost:5019
2024-09-02 14:22:02.421 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-02 14:22:02.422 +02:00 [INF] Hosting environment: Development
2024-09-02 14:22:02.423 +02:00 [INF] Content root path: C:\Users\lkelmendi.PC-PR05\Desktop\BookInventory\BookInventory
2024-09-02 14:22:04.219 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.html - null null
2024-09-02 14:22:04.645 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.html - 200 null text/html;charset=utf-8 437.0844ms
2024-09-02 14:22:04.682 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - null null
2024-09-02 14:22:04.682 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.js - null null
2024-09-02 14:22:04.684 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_vs/browserLink - null null
2024-09-02 14:22:04.695 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.js - 200 null application/javascript;charset=utf-8 13.6311ms
2024-09-02 14:22:04.699 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 17.5824ms
2024-09-02 14:22:04.767 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_vs/browserLink - 200 null text/javascript; charset=UTF-8 84.8306ms
2024-09-02 14:22:04.986 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - null null
2024-09-02 14:22:05.256 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 270.9025ms
2024-09-02 14:23:01.290 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7126/api/Auths/login - application/json-patch+json 61
2024-09-02 14:23:01.408 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory)'
2024-09-02 14:23:01.441 +02:00 [INF] Route matched with {action = "Login", controller = "Auths"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[BookInventory.DataAccessLayer.Entities.ServiceResponse`1[System.Int32]]] Login(BookInventory.BusinessLogicAcessLayer.Models.AccountModels.UserLoginModel) on controller BookInventory.APIAccessLayer.Controllers.AuthsController (BookInventory).
2024-09-02 14:23:04.042 +02:00 [INF] Executed DbCommand (147ms) [Parameters=[@__ToLower_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[PasswordHash], [t].[PasswordResetToken], [t].[PasswordSalt], [t].[ResetTokenExpires], [t].[Username], [t0].[UserId], [t0].[RoleId], [t0].[Id], [t0].[Name]
FROM (
    SELECT TOP(1) [u].[Id], [u].[PasswordHash], [u].[PasswordResetToken], [u].[PasswordSalt], [u].[ResetTokenExpires], [u].[Username]
    FROM [Users] AS [u]
    WHERE LOWER([u].[Username]) = @__ToLower_0
) AS [t]
LEFT JOIN (
    SELECT [r].[UserId], [r].[RoleId], [r0].[Id], [r0].[Name]
    FROM [RoleUsers] AS [r]
    INNER JOIN [Roles] AS [r0] ON [r].[RoleId] = [r0].[Id]
) AS [t0] ON [t].[Id] = [t0].[UserId]
ORDER BY [t].[Id], [t0].[UserId], [t0].[RoleId]
2024-09-02 14:23:04.340 +02:00 [INF] Executed DbCommand (29ms) [Parameters=[@__roleIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[PermissionId], [p].[Id], [p].[Name]
FROM [RolePermissions] AS [r]
INNER JOIN [Permissions] AS [p] ON [r].[PermissionId] = [p].[Id]
WHERE [r].[RoleId] IN (
    SELECT [r0].[value]
    FROM OPENJSON(@__roleIds_0) WITH ([value] int '$') AS [r0]
)
2024-09-02 14:23:04.415 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookInventory.DataAccessLayer.Entities.ServiceResponse`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-09-02 14:23:04.458 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory) in 3010.7756ms
2024-09-02 14:23:04.461 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory)'
2024-09-02 14:23:04.472 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7126/api/Auths/login - 200 798 application/json; charset=utf-8 3182.1288ms
2024-09-02 14:23:25.099 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/api/Books/getAllBooks?page=1&size=5 - null null
2024-09-02 14:23:25.187 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetAllBooks (BookInventory)'
2024-09-02 14:23:25.199 +02:00 [INF] Route matched with {action = "GetAllBooks", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllBooks(Int32, Int32) on controller BookInventory.APIAccessLayer.Controllers.BooksController (BookInventory).
2024-09-02 14:23:25.214 +02:00 [INF] API call to get all books started.
2024-09-02 14:23:25.216 +02:00 [INF] Fetching books from the database with pagination.
2024-09-02 14:23:25.278 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
2024-09-02 14:23:25.288 +02:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2024-09-02 14:23:25.291 +02:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2024-09-02 14:23:25.312 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AuthorId], [t].[Edition], [t].[Format], [t].[Genres], [t].[Language], [t].[PageCount], [t].[Price], [t].[PublicationYear], [t].[Stock], [t].[Title], [a].[Id], [a].[DateOfBirth], [a].[EmailAddress], [a].[ImageUrl], [a].[Name], [a].[Nationality]
FROM (
    SELECT [b].[Id], [b].[AuthorId], [b].[Edition], [b].[Format], [b].[Genres], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublicationYear], [b].[Stock], [b].[Title]
    FROM [Books] AS [b]
    ORDER BY (SELECT 1)
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t]
INNER JOIN [Authors] AS [a] ON [t].[AuthorId] = [a].[Id]
2024-09-02 14:23:25.378 +02:00 [INF] Exiting GetAllBooks method with 2 books fetched.
2024-09-02 14:23:25.380 +02:00 [INF] API call to get all books completed successfully!
2024-09-02 14:23:25.382 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookInventory.BusinessLogicAcessLayer.Helpers.PaginatedResult`1[[BookInventory.LogicAcessLayer.Models.BookModels.BookGetModel, BookInventory, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-02 14:23:25.405 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.BooksController.GetAllBooks (BookInventory) in 204.1184ms
2024-09-02 14:23:25.409 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetAllBooks (BookInventory)'
2024-09-02 14:23:25.412 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/api/Books/getAllBooks?page=1&size=5 - 200 812 application/json; charset=utf-8 312.8293ms
2024-09-02 14:23:42.049 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7126/api/Ratings/rate - application/json-patch+json 33
2024-09-02 14:23:42.060 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.RatingsController.AddRating (BookInventory)'
2024-09-02 14:23:42.065 +02:00 [INF] Route matched with {action = "AddRating", controller = "Ratings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddRating(BookInventory.BusinessLogicAcessLayer.Models.RatingModels.RatingModel) on controller BookInventory.APIAccessLayer.Controllers.RatingsController (BookInventory).
2024-09-02 14:23:42.169 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[BookId], [r].[Rate], [r].[UserId]
FROM [Ratings] AS [r]
WHERE [r].[BookId] = @__model_BookId_0
2024-09-02 14:23:42.321 +02:00 [INF] Executed DbCommand (30ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Ratings] ([BookId], [Rate], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2024-09-02 14:23:42.388 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'BookInventory.DataAccess.Database.DatabaseContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Ratings_Users_UserId". The conflict occurred in database "BookInventory", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:48235c13-f0ca-41d0-ab5b-cc26d6c6416b
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Ratings_Users_UserId". The conflict occurred in database "BookInventory", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:48235c13-f0ca-41d0-ab5b-cc26d6c6416b
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-09-02 14:23:42.627 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.RatingsController.AddRating (BookInventory) in 557.9941ms
2024-09-02 14:23:42.630 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.RatingsController.AddRating (BookInventory)'
2024-09-02 14:23:42.634 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Ratings_Users_UserId". The conflict occurred in database "BookInventory", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:48235c13-f0ca-41d0-ab5b-cc26d6c6416b
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at BookInventory.LogicAcessLayer.Services.RatingService.RatingServicee.AddRating(RatingModel model) in C:\Users\lkelmendi.PC-PR05\Desktop\BookInventory\BookInventory\BusinessLogicAcessLayer\Services\RatingService\RatingServicee.cs:line 47
   at BookInventory.APIAccessLayer.Controllers.RatingsController.AddRating(RatingModel ratingModel) in C:\Users\lkelmendi.PC-PR05\Desktop\BookInventory\BookInventory\APIAccessLayer\Controllers\RatingsController.cs:line 24
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-09-02 14:23:42.696 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7126/api/Ratings/rate - 500 null text/plain; charset=utf-8 647.6309ms
2024-09-02 14:28:54.075 +02:00 [INF] User profile is available. Using 'C:\Users\lkelmendi.PC-PR05\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-02 14:28:54.368 +02:00 [INF] Now listening on: https://localhost:7126
2024-09-02 14:28:54.369 +02:00 [INF] Now listening on: http://localhost:5019
2024-09-02 14:28:54.371 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-02 14:28:54.372 +02:00 [INF] Hosting environment: Development
2024-09-02 14:28:54.373 +02:00 [INF] Content root path: C:\Users\lkelmendi.PC-PR05\Desktop\BookInventory\BookInventory
2024-09-02 14:28:54.958 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.html - null null
2024-09-02 14:28:55.289 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.html - 200 null text/html;charset=utf-8 339.4093ms
2024-09-02 14:28:55.319 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_vs/browserLink - null null
2024-09-02 14:28:55.319 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.js - null null
2024-09-02 14:28:55.319 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - null null
2024-09-02 14:28:55.327 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.js - 200 null application/javascript;charset=utf-8 7.9504ms
2024-09-02 14:28:55.344 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 24.5724ms
2024-09-02 14:28:55.374 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_vs/browserLink - 200 null text/javascript; charset=UTF-8 55.3766ms
2024-09-02 14:28:55.439 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - null null
2024-09-02 14:28:55.661 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 222.5697ms
2024-09-02 14:35:14.792 +02:00 [INF] User profile is available. Using 'C:\Users\lkelmendi.PC-PR05\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-02 14:35:15.075 +02:00 [INF] Now listening on: https://localhost:7126
2024-09-02 14:35:15.077 +02:00 [INF] Now listening on: http://localhost:5019
2024-09-02 14:35:15.079 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-02 14:35:15.080 +02:00 [INF] Hosting environment: Development
2024-09-02 14:35:15.081 +02:00 [INF] Content root path: C:\Users\lkelmendi.PC-PR05\Desktop\BookInventory\BookInventory
2024-09-02 14:35:16.854 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.html - null null
2024-09-02 14:35:17.310 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.html - 200 null text/html;charset=utf-8 461.6174ms
2024-09-02 14:35:17.367 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - null null
2024-09-02 14:35:17.367 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_vs/browserLink - null null
2024-09-02 14:35:17.368 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.js - null null
2024-09-02 14:35:17.389 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 22.2426ms
2024-09-02 14:35:17.432 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.js - 200 null application/javascript;charset=utf-8 64.6099ms
2024-09-02 14:35:17.472 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_vs/browserLink - 200 null text/javascript; charset=UTF-8 103.1478ms
2024-09-02 14:35:17.601 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - null null
2024-09-02 14:35:17.816 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 214.9799ms
2024-09-02 14:35:29.125 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7126/api/Ratings/rate - application/json-patch+json 33
2024-09-02 14:35:30.835 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.RatingsController.AddRating (BookInventory)'
2024-09-02 14:35:30.879 +02:00 [INF] Route matched with {action = "AddRating", controller = "Ratings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddRating(BookInventory.BusinessLogicAcessLayer.Models.RatingModels.RatingModel) on controller BookInventory.APIAccessLayer.Controllers.RatingsController (BookInventory).
2024-09-02 14:35:32.985 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1+AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[BookInventory.LogicAcessLayer.Services.RatingService.RatingServicee+<AddRating>d__3, BookInventory, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-02 14:35:33.218 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.RatingsController.AddRating (BookInventory) in 2333.1878ms
2024-09-02 14:35:33.227 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.RatingsController.AddRating (BookInventory)'
2024-09-02 14:35:33.232 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Newtonsoft.Json.JsonSerializationException: Error getting value from 'Context' on 'System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1+AsyncStateMachineBox`1[System.Threading.Tasks.VoidTaskResult,BookInventory.LogicAcessLayer.Services.RatingService.RatingServicee+<AddRating>d__3]'.
 ---> System.InvalidOperationException: Could not create getter for System.Threading.ExecutionContext& Context. ByRef return values are not supported.
   at Newtonsoft.Json.Utilities.ReflectionDelegateFactory.CreateGet[T](MemberInfo memberInfo)
   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)
   --- End of inner exception stack trace ---
   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.CalculatePropertyValues(JsonWriter writer, Object value, JsonContainerContract contract, JsonProperty member, JsonProperty property, JsonContract& memberContract, Object& memberValue)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeValue(JsonWriter writer, Object value, JsonContract valueContract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)
   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)
   at Newtonsoft.Json.JsonSerializer.Serialize(JsonWriter jsonWriter, Object value)
   at Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-09-02 14:35:33.256 +02:00 [INF] Executed DbCommand (67ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[BookId], [r].[Rate], [r].[UserId]
FROM [Ratings] AS [r]
WHERE [r].[BookId] = @__model_BookId_0
2024-09-02 14:35:33.302 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7126/api/Ratings/rate - 500 null text/plain; charset=utf-8 4177.4257ms
2024-09-02 14:38:48.932 +02:00 [INF] User profile is available. Using 'C:\Users\lkelmendi.PC-PR05\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-02 14:38:49.231 +02:00 [INF] Now listening on: https://localhost:7126
2024-09-02 14:38:49.232 +02:00 [INF] Now listening on: http://localhost:5019
2024-09-02 14:38:49.235 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-02 14:38:49.236 +02:00 [INF] Hosting environment: Development
2024-09-02 14:38:49.237 +02:00 [INF] Content root path: C:\Users\lkelmendi.PC-PR05\Desktop\BookInventory\BookInventory
2024-09-02 14:38:50.443 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.html - null null
2024-09-02 14:38:51.077 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.html - 200 null text/html;charset=utf-8 640.8692ms
2024-09-02 14:38:51.128 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - null null
2024-09-02 14:38:51.128 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.js - null null
2024-09-02 14:38:51.128 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_vs/browserLink - null null
2024-09-02 14:38:51.181 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.js - 200 null application/javascript;charset=utf-8 53.1468ms
2024-09-02 14:38:51.230 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 102.5777ms
2024-09-02 14:38:51.406 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_vs/browserLink - 200 null text/javascript; charset=UTF-8 277.8197ms
2024-09-02 14:38:51.515 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - null null
2024-09-02 14:38:51.698 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 183.7642ms
2024-09-02 14:39:00.870 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7126/api/Ratings/rate - application/json-patch+json 33
2024-09-02 14:39:00.963 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.RatingsController.AddRating (BookInventory)'
2024-09-02 14:39:00.992 +02:00 [INF] Route matched with {action = "AddRating", controller = "Ratings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddRating(BookInventory.BusinessLogicAcessLayer.Models.RatingModels.RatingModel) on controller BookInventory.APIAccessLayer.Controllers.RatingsController (BookInventory).
2024-09-02 14:39:02.852 +02:00 [INF] Executed DbCommand (69ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[BookId], [r].[Rate], [r].[UserId]
FROM [Ratings] AS [r]
WHERE [r].[BookId] = @__model_BookId_0
2024-09-02 14:39:03.067 +02:00 [INF] Executed DbCommand (22ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Ratings] ([BookId], [Rate], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2024-09-02 14:39:03.110 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'BookInventory.DataAccess.Database.DatabaseContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Ratings_Users_UserId". The conflict occurred in database "BookInventory", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d1459cdc-6a79-43a3-9a06-925fdd189039
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Ratings_Users_UserId". The conflict occurred in database "BookInventory", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d1459cdc-6a79-43a3-9a06-925fdd189039
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-09-02 14:39:03.288 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.RatingsController.AddRating (BookInventory) in 2289.9126ms
2024-09-02 14:39:03.292 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.RatingsController.AddRating (BookInventory)'
2024-09-02 14:39:03.298 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Ratings_Users_UserId". The conflict occurred in database "BookInventory", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d1459cdc-6a79-43a3-9a06-925fdd189039
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at BookInventory.LogicAcessLayer.Services.RatingService.RatingServicee.AddRating(RatingModel model) in C:\Users\lkelmendi.PC-PR05\Desktop\BookInventory\BookInventory\BusinessLogicAcessLayer\Services\RatingService\RatingServicee.cs:line 44
   at BookInventory.APIAccessLayer.Controllers.RatingsController.AddRating(RatingModel ratingModel) in C:\Users\lkelmendi.PC-PR05\Desktop\BookInventory\BookInventory\APIAccessLayer\Controllers\RatingsController.cs:line 24
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-09-02 14:39:03.367 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7126/api/Ratings/rate - 500 null text/plain; charset=utf-8 2497.372ms
2024-09-02 14:44:13.008 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-09-02 14:44:13.069 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-09-02 14:44:13.071 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-09-02 14:44:13.073 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-09-02 14:44:13.092 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2024-09-02 14:44:13.103 +02:00 [INF] Applying migration '20240902124402_Ratingsss'.
2024-09-02 14:44:13.210 +02:00 [INF] Executed DbCommand (64ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP TABLE [Ratings];
2024-09-02 14:44:13.216 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20240902124402_Ratingsss', N'8.0.8');
2024-09-02 15:29:45.545 +02:00 [INF] User profile is available. Using 'C:\Users\lkelmendi.PC-PR05\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-02 15:29:46.090 +02:00 [INF] Now listening on: https://localhost:7126
2024-09-02 15:29:46.091 +02:00 [INF] Now listening on: http://localhost:5019
2024-09-02 15:29:46.094 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-02 15:29:46.095 +02:00 [INF] Hosting environment: Development
2024-09-02 15:29:46.096 +02:00 [INF] Content root path: C:\Users\lkelmendi.PC-PR05\Desktop\BookInventory\BookInventory
2024-09-02 15:29:47.910 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.html - null null
2024-09-02 15:29:48.312 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.html - 200 null text/html;charset=utf-8 414.5508ms
2024-09-02 15:29:48.359 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.js - null null
2024-09-02 15:29:48.363 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - null null
2024-09-02 15:29:48.367 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.js - 200 null application/javascript;charset=utf-8 8.7481ms
2024-09-02 15:29:48.389 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_vs/browserLink - null null
2024-09-02 15:29:48.393 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 30.3081ms
2024-09-02 15:29:48.464 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_vs/browserLink - 200 null text/javascript; charset=UTF-8 74.8238ms
2024-09-02 15:29:48.579 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - null null
2024-09-02 15:29:48.833 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 254.0288ms
2024-09-02 15:30:10.136 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7126/api/Auths/login - application/json-patch+json 61
2024-09-02 15:30:10.287 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory)'
2024-09-02 15:30:10.392 +02:00 [INF] Route matched with {action = "Login", controller = "Auths"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[BookInventory.DataAccessLayer.Entities.ServiceResponse`1[System.Int32]]] Login(BookInventory.BusinessLogicAcessLayer.Models.AccountModels.UserLoginModel) on controller BookInventory.APIAccessLayer.Controllers.AuthsController (BookInventory).
2024-09-02 15:30:14.816 +02:00 [INF] Executed DbCommand (172ms) [Parameters=[@__ToLower_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[PasswordHash], [t].[PasswordResetToken], [t].[PasswordSalt], [t].[ResetTokenExpires], [t].[Username], [t0].[UserId], [t0].[RoleId], [t0].[Id], [t0].[Name]
FROM (
    SELECT TOP(1) [u].[Id], [u].[PasswordHash], [u].[PasswordResetToken], [u].[PasswordSalt], [u].[ResetTokenExpires], [u].[Username]
    FROM [Users] AS [u]
    WHERE LOWER([u].[Username]) = @__ToLower_0
) AS [t]
LEFT JOIN (
    SELECT [r].[UserId], [r].[RoleId], [r0].[Id], [r0].[Name]
    FROM [RoleUsers] AS [r]
    INNER JOIN [Roles] AS [r0] ON [r].[RoleId] = [r0].[Id]
) AS [t0] ON [t].[Id] = [t0].[UserId]
ORDER BY [t].[Id], [t0].[UserId], [t0].[RoleId]
2024-09-02 15:30:15.064 +02:00 [INF] Executed DbCommand (43ms) [Parameters=[@__roleIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[PermissionId], [p].[Id], [p].[Name]
FROM [RolePermissions] AS [r]
INNER JOIN [Permissions] AS [p] ON [r].[PermissionId] = [p].[Id]
WHERE [r].[RoleId] IN (
    SELECT [r0].[value]
    FROM OPENJSON(@__roleIds_0) WITH ([value] int '$') AS [r0]
)
2024-09-02 15:30:15.130 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookInventory.DataAccessLayer.Entities.ServiceResponse`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-09-02 15:30:15.163 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory) in 4756.3857ms
2024-09-02 15:30:15.167 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory)'
2024-09-02 15:30:15.178 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7126/api/Auths/login - 200 798 application/json; charset=utf-8 5041.7044ms
2024-09-02 15:30:40.080 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/api/Books/getAllBooks?page=1&size=5 - null null
2024-09-02 15:30:40.194 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetAllBooks (BookInventory)'
2024-09-02 15:30:40.203 +02:00 [INF] Route matched with {action = "GetAllBooks", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllBooks(Int32, Int32) on controller BookInventory.APIAccessLayer.Controllers.BooksController (BookInventory).
2024-09-02 15:30:40.215 +02:00 [INF] API call to get all books started.
2024-09-02 15:30:40.217 +02:00 [INF] Fetching books from the database with pagination.
2024-09-02 15:30:40.262 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
2024-09-02 15:30:40.274 +02:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2024-09-02 15:30:40.275 +02:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2024-09-02 15:30:40.294 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AuthorId], [t].[Edition], [t].[Format], [t].[Genres], [t].[Language], [t].[PageCount], [t].[Price], [t].[PublicationYear], [t].[Stock], [t].[Title], [a].[Id], [a].[DateOfBirth], [a].[EmailAddress], [a].[ImageUrl], [a].[Name], [a].[Nationality]
FROM (
    SELECT [b].[Id], [b].[AuthorId], [b].[Edition], [b].[Format], [b].[Genres], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublicationYear], [b].[Stock], [b].[Title]
    FROM [Books] AS [b]
    ORDER BY (SELECT 1)
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t]
INNER JOIN [Authors] AS [a] ON [t].[AuthorId] = [a].[Id]
2024-09-02 15:30:40.358 +02:00 [INF] Exiting GetAllBooks method with 2 books fetched.
2024-09-02 15:30:40.360 +02:00 [INF] API call to get all books completed successfully!
2024-09-02 15:30:40.362 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookInventory.BusinessLogicAcessLayer.Helpers.PaginatedResult`1[[BookInventory.LogicAcessLayer.Models.BookModels.BookGetModel, BookInventory, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-02 15:30:40.385 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.BooksController.GetAllBooks (BookInventory) in 179.6212ms
2024-09-02 15:30:40.386 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetAllBooks (BookInventory)'
2024-09-02 15:30:40.389 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/api/Books/getAllBooks?page=1&size=5 - 200 812 application/json; charset=utf-8 308.2682ms
2024-09-02 15:30:51.157 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/2015?publicationYear=2015 - null null
2024-09-02 15:30:51.173 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:30:51.180 +02:00 [INF] Route matched with {action = "GetBooksByPublicationYear", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetBooksByPublicationYear(Int32) on controller BookInventory.APIAccessLayer.Controllers.BooksController (BookInventory).
2024-09-02 15:30:51.187 +02:00 [INF] API call to get books by publication year: 2015.
2024-09-02 15:30:51.191 +02:00 [INF] Fetching books filtered by publication year from the database.
2024-09-02 15:30:51.283 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[@__publicationYear_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[Id], [b].[AuthorId], [b].[Edition], [b].[Format], [b].[Genres], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublicationYear], [b].[Stock], [b].[Title], [a].[Id], [a].[DateOfBirth], [a].[EmailAddress], [a].[ImageUrl], [a].[Name], [a].[Nationality]
FROM [Books] AS [b]
INNER JOIN [Authors] AS [a] ON [b].[AuthorId] = [a].[Id]
WHERE [b].[PublicationYear] = @__publicationYear_0
2024-09-02 15:30:51.288 +02:00 [INF] Exiting GetBooksByPublicationYear method with 1 books fetched.
2024-09-02 15:30:51.290 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookInventory.LogicAcessLayer.Models.BookModels.BookGetModel, BookInventory, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-02 15:30:51.292 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory) in 109.8441ms
2024-09-02 15:30:51.294 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:30:51.295 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/2015?publicationYear=2015 - 200 344 application/json; charset=utf-8 138.0952ms
2024-09-02 15:31:14.714 +02:00 [INF] User profile is available. Using 'C:\Users\lkelmendi.PC-PR05\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-02 15:31:14.999 +02:00 [INF] Now listening on: https://localhost:7126
2024-09-02 15:31:15.000 +02:00 [INF] Now listening on: http://localhost:5019
2024-09-02 15:31:15.001 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-02 15:31:15.002 +02:00 [INF] Hosting environment: Development
2024-09-02 15:31:15.003 +02:00 [INF] Content root path: C:\Users\lkelmendi.PC-PR05\Desktop\BookInventory\BookInventory
2024-09-02 15:31:15.802 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.html - null null
2024-09-02 15:31:16.091 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.html - 200 null text/html;charset=utf-8 294.2677ms
2024-09-02 15:31:16.140 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - null null
2024-09-02 15:31:16.140 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.js - null null
2024-09-02 15:31:16.140 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_vs/browserLink - null null
2024-09-02 15:31:16.151 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.js - 200 null application/javascript;charset=utf-8 11.1421ms
2024-09-02 15:31:16.159 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 19.8068ms
2024-09-02 15:31:16.246 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_vs/browserLink - 200 null text/javascript; charset=UTF-8 105.2973ms
2024-09-02 15:31:16.304 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - null null
2024-09-02 15:31:16.499 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 195.875ms
2024-09-02 15:32:32.567 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7126/api/Auths/login - application/json-patch+json 61
2024-09-02 15:32:32.705 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory)'
2024-09-02 15:32:32.736 +02:00 [INF] Route matched with {action = "Login", controller = "Auths"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[BookInventory.DataAccessLayer.Entities.ServiceResponse`1[System.Int32]]] Login(BookInventory.BusinessLogicAcessLayer.Models.AccountModels.UserLoginModel) on controller BookInventory.APIAccessLayer.Controllers.AuthsController (BookInventory).
2024-09-02 15:32:35.042 +02:00 [INF] Executed DbCommand (70ms) [Parameters=[@__ToLower_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[PasswordHash], [t].[PasswordResetToken], [t].[PasswordSalt], [t].[ResetTokenExpires], [t].[Username], [t0].[UserId], [t0].[RoleId], [t0].[Id], [t0].[Name]
FROM (
    SELECT TOP(1) [u].[Id], [u].[PasswordHash], [u].[PasswordResetToken], [u].[PasswordSalt], [u].[ResetTokenExpires], [u].[Username]
    FROM [Users] AS [u]
    WHERE LOWER([u].[Username]) = @__ToLower_0
) AS [t]
LEFT JOIN (
    SELECT [r].[UserId], [r].[RoleId], [r0].[Id], [r0].[Name]
    FROM [RoleUsers] AS [r]
    INNER JOIN [Roles] AS [r0] ON [r].[RoleId] = [r0].[Id]
) AS [t0] ON [t].[Id] = [t0].[UserId]
ORDER BY [t].[Id], [t0].[UserId], [t0].[RoleId]
2024-09-02 15:32:35.263 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@__roleIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[PermissionId], [p].[Id], [p].[Name]
FROM [RolePermissions] AS [r]
INNER JOIN [Permissions] AS [p] ON [r].[PermissionId] = [p].[Id]
WHERE [r].[RoleId] IN (
    SELECT [r0].[value]
    FROM OPENJSON(@__roleIds_0) WITH ([value] int '$') AS [r0]
)
2024-09-02 15:32:35.323 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookInventory.DataAccessLayer.Entities.ServiceResponse`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-09-02 15:32:35.360 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory) in 2618.5973ms
2024-09-02 15:32:35.363 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory)'
2024-09-02 15:32:35.375 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7126/api/Auths/login - 200 798 application/json; charset=utf-8 2808.3524ms
2024-09-02 15:32:52.444 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/1997 - null null
2024-09-02 15:32:52.535 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:32:52.541 +02:00 [INF] Route matched with {action = "GetBooksByPublicationYear", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetBooksByPublicationYear(Int32) on controller BookInventory.APIAccessLayer.Controllers.BooksController (BookInventory).
2024-09-02 15:32:52.550 +02:00 [INF] API call to get books by publication year: 1997.
2024-09-02 15:32:52.552 +02:00 [INF] Fetching books filtered by publication year from the database.
2024-09-02 15:32:52.587 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__publicationYear_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[Id], [b].[AuthorId], [b].[Edition], [b].[Format], [b].[Genres], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublicationYear], [b].[Stock], [b].[Title], [a].[Id], [a].[DateOfBirth], [a].[EmailAddress], [a].[ImageUrl], [a].[Name], [a].[Nationality]
FROM [Books] AS [b]
INNER JOIN [Authors] AS [a] ON [b].[AuthorId] = [a].[Id]
WHERE [b].[PublicationYear] = @__publicationYear_0
2024-09-02 15:32:52.606 +02:00 [INF] Exiting GetBooksByPublicationYear method with 0 books fetched.
2024-09-02 15:32:52.610 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookInventory.LogicAcessLayer.Models.BookModels.BookGetModel, BookInventory, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-02 15:32:52.621 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory) in 76.2666ms
2024-09-02 15:32:52.623 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:32:52.626 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/1997 - 200 2 application/json; charset=utf-8 182.6315ms
2024-09-02 15:32:56.644 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/1995 - null null
2024-09-02 15:32:56.660 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:32:56.662 +02:00 [INF] Route matched with {action = "GetBooksByPublicationYear", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetBooksByPublicationYear(Int32) on controller BookInventory.APIAccessLayer.Controllers.BooksController (BookInventory).
2024-09-02 15:32:56.671 +02:00 [INF] API call to get books by publication year: 1995.
2024-09-02 15:32:56.673 +02:00 [INF] Fetching books filtered by publication year from the database.
2024-09-02 15:32:56.746 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__publicationYear_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[Id], [b].[AuthorId], [b].[Edition], [b].[Format], [b].[Genres], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublicationYear], [b].[Stock], [b].[Title], [a].[Id], [a].[DateOfBirth], [a].[EmailAddress], [a].[ImageUrl], [a].[Name], [a].[Nationality]
FROM [Books] AS [b]
INNER JOIN [Authors] AS [a] ON [b].[AuthorId] = [a].[Id]
WHERE [b].[PublicationYear] = @__publicationYear_0
2024-09-02 15:32:56.753 +02:00 [INF] Exiting GetBooksByPublicationYear method with 0 books fetched.
2024-09-02 15:32:56.754 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookInventory.LogicAcessLayer.Models.BookModels.BookGetModel, BookInventory, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-02 15:32:56.755 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory) in 86.3674ms
2024-09-02 15:32:56.757 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:32:56.758 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/1995 - 200 2 application/json; charset=utf-8 113.942ms
2024-09-02 15:33:01.186 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/1955 - null null
2024-09-02 15:33:01.193 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:33:01.195 +02:00 [INF] Route matched with {action = "GetBooksByPublicationYear", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetBooksByPublicationYear(Int32) on controller BookInventory.APIAccessLayer.Controllers.BooksController (BookInventory).
2024-09-02 15:33:01.204 +02:00 [INF] API call to get books by publication year: 1955.
2024-09-02 15:33:01.205 +02:00 [INF] Fetching books filtered by publication year from the database.
2024-09-02 15:33:01.211 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__publicationYear_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[Id], [b].[AuthorId], [b].[Edition], [b].[Format], [b].[Genres], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublicationYear], [b].[Stock], [b].[Title], [a].[Id], [a].[DateOfBirth], [a].[EmailAddress], [a].[ImageUrl], [a].[Name], [a].[Nationality]
FROM [Books] AS [b]
INNER JOIN [Authors] AS [a] ON [b].[AuthorId] = [a].[Id]
WHERE [b].[PublicationYear] = @__publicationYear_0
2024-09-02 15:33:01.266 +02:00 [INF] Exiting GetBooksByPublicationYear method with 1 books fetched.
2024-09-02 15:33:01.269 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookInventory.LogicAcessLayer.Models.BookModels.BookGetModel, BookInventory, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-02 15:33:01.279 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory) in 77.6433ms
2024-09-02 15:33:01.285 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:33:01.286 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/1955 - 200 342 application/json; charset=utf-8 100.22ms
2024-09-02 15:36:20.228 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7126/api/Books/addBook - application/json-patch+json 247
2024-09-02 15:36:20.233 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.AddBook (BookInventory)'
2024-09-02 15:36:20.238 +02:00 [INF] Route matched with {action = "AddBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddBook(BookInventory.LogicAcessLayer.Models.BookModels.BookCreateModel) on controller BookInventory.APIAccessLayer.Controllers.BooksController (BookInventory).
2024-09-02 15:36:20.261 +02:00 [INF] API call to add a new book.
2024-09-02 15:36:20.264 +02:00 [INF] Creating a new book in the database.
2024-09-02 15:36:20.402 +02:00 [INF] Executed DbCommand (23ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 30), @p2='?' (Size = 20), @p3='?' (Size = 4000), @p4='?' (Size = 40), @p5='?' (DbType = Int32), @p6='?' (DbType = Double), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Books] ([AuthorId], [Edition], [Format], [Genres], [Language], [PageCount], [Price], [PublicationYear], [Stock], [Title])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2024-09-02 15:36:20.428 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2024-09-02 15:36:20.430 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.BooksController.AddBook (BookInventory) in 190.5102ms
2024-09-02 15:36:20.433 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.AddBook (BookInventory)'
2024-09-02 15:36:20.434 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7126/api/Books/addBook - 200 null text/plain; charset=utf-8 206.0792ms
2024-09-02 15:36:29.852 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/2015 - null null
2024-09-02 15:36:29.891 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:36:29.898 +02:00 [INF] Route matched with {action = "GetBooksByPublicationYear", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetBooksByPublicationYear(Int32) on controller BookInventory.APIAccessLayer.Controllers.BooksController (BookInventory).
2024-09-02 15:36:29.902 +02:00 [INF] API call to get books by publication year: 2015.
2024-09-02 15:36:29.904 +02:00 [INF] Fetching books filtered by publication year from the database.
2024-09-02 15:36:29.915 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__publicationYear_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[Id], [b].[AuthorId], [b].[Edition], [b].[Format], [b].[Genres], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublicationYear], [b].[Stock], [b].[Title], [a].[Id], [a].[DateOfBirth], [a].[EmailAddress], [a].[ImageUrl], [a].[Name], [a].[Nationality]
FROM [Books] AS [b]
INNER JOIN [Authors] AS [a] ON [b].[AuthorId] = [a].[Id]
WHERE [b].[PublicationYear] = @__publicationYear_0
2024-09-02 15:36:29.920 +02:00 [INF] Exiting GetBooksByPublicationYear method with 2 books fetched.
2024-09-02 15:36:29.921 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookInventory.LogicAcessLayer.Models.BookModels.BookGetModel, BookInventory, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-02 15:36:29.922 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory) in 20.4301ms
2024-09-02 15:36:29.924 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:36:29.928 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/2015 - 200 692 application/json; charset=utf-8 75.9572ms
2024-09-02 15:44:06.105 +02:00 [INF] User profile is available. Using 'C:\Users\lkelmendi.PC-PR05\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-02 15:44:06.397 +02:00 [INF] Now listening on: https://localhost:7126
2024-09-02 15:44:06.399 +02:00 [INF] Now listening on: http://localhost:5019
2024-09-02 15:44:06.401 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-02 15:44:06.402 +02:00 [INF] Hosting environment: Development
2024-09-02 15:44:06.403 +02:00 [INF] Content root path: C:\Users\lkelmendi.PC-PR05\Desktop\BookInventory\BookInventory
2024-09-02 15:44:08.073 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.html - null null
2024-09-02 15:44:08.455 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.html - 200 null text/html;charset=utf-8 379.945ms
2024-09-02 15:44:08.485 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_vs/browserLink - null null
2024-09-02 15:44:08.485 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.js - null null
2024-09-02 15:44:08.485 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - null null
2024-09-02 15:44:08.502 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.js - 200 null application/javascript;charset=utf-8 17.4767ms
2024-09-02 15:44:08.519 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 35.3949ms
2024-09-02 15:44:08.540 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_vs/browserLink - 200 null text/javascript; charset=UTF-8 55.4876ms
2024-09-02 15:44:08.617 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - null null
2024-09-02 15:44:08.819 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 201.7191ms
2024-09-02 15:44:16.124 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/6666 - null null
2024-09-02 15:44:16.221 +02:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
ClaimsAuthorizationRequirement:Claim.Type=permissions and Claim.Value is one of the following values: (Book_Read)
2024-09-02 15:44:16.226 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2024-09-02 15:44:16.230 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/6666 - 401 0 null 105.4006ms
2024-09-02 15:44:34.789 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7126/api/Auths/login - application/json-patch+json 61
2024-09-02 15:44:34.802 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory)'
2024-09-02 15:44:34.830 +02:00 [INF] Route matched with {action = "Login", controller = "Auths"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[BookInventory.DataAccessLayer.Entities.ServiceResponse`1[System.Int32]]] Login(BookInventory.BusinessLogicAcessLayer.Models.AccountModels.UserLoginModel) on controller BookInventory.APIAccessLayer.Controllers.AuthsController (BookInventory).
2024-09-02 15:44:36.594 +02:00 [INF] Executed DbCommand (72ms) [Parameters=[@__ToLower_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[PasswordHash], [t].[PasswordResetToken], [t].[PasswordSalt], [t].[ResetTokenExpires], [t].[Username], [t0].[UserId], [t0].[RoleId], [t0].[Id], [t0].[Name]
FROM (
    SELECT TOP(1) [u].[Id], [u].[PasswordHash], [u].[PasswordResetToken], [u].[PasswordSalt], [u].[ResetTokenExpires], [u].[Username]
    FROM [Users] AS [u]
    WHERE LOWER([u].[Username]) = @__ToLower_0
) AS [t]
LEFT JOIN (
    SELECT [r].[UserId], [r].[RoleId], [r0].[Id], [r0].[Name]
    FROM [RoleUsers] AS [r]
    INNER JOIN [Roles] AS [r0] ON [r].[RoleId] = [r0].[Id]
) AS [t0] ON [t].[Id] = [t0].[UserId]
ORDER BY [t].[Id], [t0].[UserId], [t0].[RoleId]
2024-09-02 15:44:36.794 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@__roleIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[PermissionId], [p].[Id], [p].[Name]
FROM [RolePermissions] AS [r]
INNER JOIN [Permissions] AS [p] ON [r].[PermissionId] = [p].[Id]
WHERE [r].[RoleId] IN (
    SELECT [r0].[value]
    FROM OPENJSON(@__roleIds_0) WITH ([value] int '$') AS [r0]
)
2024-09-02 15:44:36.859 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookInventory.DataAccessLayer.Entities.ServiceResponse`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-09-02 15:44:36.898 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory) in 2058.1894ms
2024-09-02 15:44:36.901 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory)'
2024-09-02 15:44:36.911 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7126/api/Auths/login - 200 798 application/json; charset=utf-8 2121.7859ms
2024-09-02 15:44:50.854 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/6666 - null null
2024-09-02 15:44:50.920 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:44:50.927 +02:00 [INF] Route matched with {action = "GetBooksByPublicationYear", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetBooksByPublicationYear(Int32) on controller BookInventory.APIAccessLayer.Controllers.BooksController (BookInventory).
2024-09-02 15:44:50.939 +02:00 [INF] API call to get books by publication year: 6666.
2024-09-02 15:44:50.943 +02:00 [INF] Fetching books filtered by publication year from the database.
2024-09-02 15:44:50.984 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__publicationYear_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[Id], [b].[AuthorId], [b].[Edition], [b].[Format], [b].[Genres], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublicationYear], [b].[Stock], [b].[Title], [a].[Id], [a].[DateOfBirth], [a].[EmailAddress], [a].[ImageUrl], [a].[Name], [a].[Nationality]
FROM [Books] AS [b]
INNER JOIN [Authors] AS [a] ON [b].[AuthorId] = [a].[Id]
WHERE [b].[PublicationYear] = @__publicationYear_0
2024-09-02 15:44:51.002 +02:00 [INF] Exiting GetBooksByPublicationYear method with 0 books fetched.
2024-09-02 15:44:51.005 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookInventory.LogicAcessLayer.Models.BookModels.BookGetModel, BookInventory, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-02 15:44:51.015 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory) in 83.6433ms
2024-09-02 15:44:51.019 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:44:51.020 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/6666 - 200 2 application/json; charset=utf-8 166.1312ms
2024-09-02 15:46:35.804 +02:00 [INF] User profile is available. Using 'C:\Users\lkelmendi.PC-PR05\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-02 15:46:36.097 +02:00 [INF] Now listening on: https://localhost:7126
2024-09-02 15:46:36.098 +02:00 [INF] Now listening on: http://localhost:5019
2024-09-02 15:46:36.100 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-02 15:46:36.101 +02:00 [INF] Hosting environment: Development
2024-09-02 15:46:36.102 +02:00 [INF] Content root path: C:\Users\lkelmendi.PC-PR05\Desktop\BookInventory\BookInventory
2024-09-02 15:46:37.070 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.html - null null
2024-09-02 15:46:37.436 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.html - 200 null text/html;charset=utf-8 372.6787ms
2024-09-02 15:46:37.467 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.js - null null
2024-09-02 15:46:37.467 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - null null
2024-09-02 15:46:37.468 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_vs/browserLink - null null
2024-09-02 15:46:37.482 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.js - 200 null application/javascript;charset=utf-8 15.0373ms
2024-09-02 15:46:37.495 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 27.9472ms
2024-09-02 15:46:37.552 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_vs/browserLink - 200 null text/javascript; charset=UTF-8 84.0825ms
2024-09-02 15:46:37.617 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - null null
2024-09-02 15:46:37.831 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 214.0186ms
2024-09-02 15:47:11.540 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7126/api/Auths/login - application/json-patch+json 61
2024-09-02 15:47:11.644 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory)'
2024-09-02 15:47:11.668 +02:00 [INF] Route matched with {action = "Login", controller = "Auths"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[BookInventory.DataAccessLayer.Entities.ServiceResponse`1[System.Int32]]] Login(BookInventory.BusinessLogicAcessLayer.Models.AccountModels.UserLoginModel) on controller BookInventory.APIAccessLayer.Controllers.AuthsController (BookInventory).
2024-09-02 15:47:13.555 +02:00 [INF] Executed DbCommand (67ms) [Parameters=[@__ToLower_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[PasswordHash], [t].[PasswordResetToken], [t].[PasswordSalt], [t].[ResetTokenExpires], [t].[Username], [t0].[UserId], [t0].[RoleId], [t0].[Id], [t0].[Name]
FROM (
    SELECT TOP(1) [u].[Id], [u].[PasswordHash], [u].[PasswordResetToken], [u].[PasswordSalt], [u].[ResetTokenExpires], [u].[Username]
    FROM [Users] AS [u]
    WHERE LOWER([u].[Username]) = @__ToLower_0
) AS [t]
LEFT JOIN (
    SELECT [r].[UserId], [r].[RoleId], [r0].[Id], [r0].[Name]
    FROM [RoleUsers] AS [r]
    INNER JOIN [Roles] AS [r0] ON [r].[RoleId] = [r0].[Id]
) AS [t0] ON [t].[Id] = [t0].[UserId]
ORDER BY [t].[Id], [t0].[UserId], [t0].[RoleId]
2024-09-02 15:47:13.747 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__roleIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[PermissionId], [p].[Id], [p].[Name]
FROM [RolePermissions] AS [r]
INNER JOIN [Permissions] AS [p] ON [r].[PermissionId] = [p].[Id]
WHERE [r].[RoleId] IN (
    SELECT [r0].[value]
    FROM OPENJSON(@__roleIds_0) WITH ([value] int '$') AS [r0]
)
2024-09-02 15:47:13.806 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookInventory.DataAccessLayer.Entities.ServiceResponse`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-09-02 15:47:13.838 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory) in 2164.9484ms
2024-09-02 15:47:13.843 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory)'
2024-09-02 15:47:13.852 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7126/api/Auths/login - 200 798 application/json; charset=utf-8 2312.1168ms
2024-09-02 15:47:30.341 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/11 - null null
2024-09-02 15:47:30.415 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:47:30.420 +02:00 [INF] Route matched with {action = "GetBooksByPublicationYear", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetBooksByPublicationYear(Int32) on controller BookInventory.APIAccessLayer.Controllers.BooksController (BookInventory).
2024-09-02 15:47:30.429 +02:00 [INF] API call to get books by publication year: 11.
2024-09-02 15:47:30.431 +02:00 [INF] Fetching books filtered by publication year from the database.
2024-09-02 15:47:30.466 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__publicationYear_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[Id], [b].[AuthorId], [b].[Edition], [b].[Format], [b].[Genres], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublicationYear], [b].[Stock], [b].[Title], [a].[Id], [a].[DateOfBirth], [a].[EmailAddress], [a].[ImageUrl], [a].[Name], [a].[Nationality]
FROM [Books] AS [b]
INNER JOIN [Authors] AS [a] ON [b].[AuthorId] = [a].[Id]
WHERE [b].[PublicationYear] = @__publicationYear_0
2024-09-02 15:47:30.485 +02:00 [INF] Exiting GetBooksByPublicationYear method with 0 books fetched.
2024-09-02 15:47:30.487 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookInventory.LogicAcessLayer.Models.BookModels.BookGetModel, BookInventory, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-02 15:47:30.503 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory) in 80.3446ms
2024-09-02 15:47:30.511 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:47:30.513 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/11 - 200 2 application/json; charset=utf-8 171.7508ms
2024-09-02 15:47:32.440 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/11 - null null
2024-09-02 15:47:32.451 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:47:32.455 +02:00 [INF] Route matched with {action = "GetBooksByPublicationYear", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetBooksByPublicationYear(Int32) on controller BookInventory.APIAccessLayer.Controllers.BooksController (BookInventory).
2024-09-02 15:47:32.459 +02:00 [INF] API call to get books by publication year: 11.
2024-09-02 15:47:32.461 +02:00 [INF] Fetching books filtered by publication year from the database.
2024-09-02 15:47:32.522 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__publicationYear_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[Id], [b].[AuthorId], [b].[Edition], [b].[Format], [b].[Genres], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublicationYear], [b].[Stock], [b].[Title], [a].[Id], [a].[DateOfBirth], [a].[EmailAddress], [a].[ImageUrl], [a].[Name], [a].[Nationality]
FROM [Books] AS [b]
INNER JOIN [Authors] AS [a] ON [b].[AuthorId] = [a].[Id]
WHERE [b].[PublicationYear] = @__publicationYear_0
2024-09-02 15:47:32.526 +02:00 [INF] Exiting GetBooksByPublicationYear method with 0 books fetched.
2024-09-02 15:47:32.527 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookInventory.LogicAcessLayer.Models.BookModels.BookGetModel, BookInventory, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-02 15:47:32.528 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory) in 71.7693ms
2024-09-02 15:47:32.530 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:47:32.531 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/11 - 200 2 application/json; charset=utf-8 91.5695ms
2024-09-02 15:48:20.998 +02:00 [INF] User profile is available. Using 'C:\Users\lkelmendi.PC-PR05\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-02 15:48:21.300 +02:00 [INF] Now listening on: https://localhost:7126
2024-09-02 15:48:21.301 +02:00 [INF] Now listening on: http://localhost:5019
2024-09-02 15:48:21.304 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-02 15:48:21.305 +02:00 [INF] Hosting environment: Development
2024-09-02 15:48:21.306 +02:00 [INF] Content root path: C:\Users\lkelmendi.PC-PR05\Desktop\BookInventory\BookInventory
2024-09-02 15:48:22.321 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.html - null null
2024-09-02 15:48:22.730 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.html - 200 null text/html;charset=utf-8 414.521ms
2024-09-02 15:48:22.764 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - null null
2024-09-02 15:48:22.764 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.js - null null
2024-09-02 15:48:22.765 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_vs/browserLink - null null
2024-09-02 15:48:22.769 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.js - 200 null application/javascript;charset=utf-8 5.2128ms
2024-09-02 15:48:22.779 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 15.5812ms
2024-09-02 15:48:22.863 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_vs/browserLink - 200 null text/javascript; charset=UTF-8 98.0074ms
2024-09-02 15:48:22.922 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - null null
2024-09-02 15:48:23.160 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 238.5357ms
2024-09-02 15:48:30.958 +02:00 [INF] User profile is available. Using 'C:\Users\lkelmendi.PC-PR05\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-02 15:48:31.262 +02:00 [INF] Now listening on: https://localhost:7126
2024-09-02 15:48:31.263 +02:00 [INF] Now listening on: http://localhost:5019
2024-09-02 15:48:31.266 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-02 15:48:31.267 +02:00 [INF] Hosting environment: Development
2024-09-02 15:48:31.268 +02:00 [INF] Content root path: C:\Users\lkelmendi.PC-PR05\Desktop\BookInventory\BookInventory
2024-09-02 15:48:31.653 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.html - null null
2024-09-02 15:48:31.980 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.html - 200 null text/html;charset=utf-8 326.5962ms
2024-09-02 15:48:32.012 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - null null
2024-09-02 15:48:32.013 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/index.js - null null
2024-09-02 15:48:32.013 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/_vs/browserLink - null null
2024-09-02 15:48:32.022 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/index.js - 200 null application/javascript;charset=utf-8 8.9441ms
2024-09-02 15:48:32.033 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 21.0369ms
2024-09-02 15:48:32.110 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/_vs/browserLink - 200 null text/javascript; charset=UTF-8 97.1951ms
2024-09-02 15:48:32.169 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - null null
2024-09-02 15:48:32.362 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 193.6009ms
2024-09-02 15:48:49.938 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7126/api/Auths/login - application/json-patch+json 61
2024-09-02 15:48:50.036 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory)'
2024-09-02 15:48:50.069 +02:00 [INF] Route matched with {action = "Login", controller = "Auths"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[BookInventory.DataAccessLayer.Entities.ServiceResponse`1[System.Int32]]] Login(BookInventory.BusinessLogicAcessLayer.Models.AccountModels.UserLoginModel) on controller BookInventory.APIAccessLayer.Controllers.AuthsController (BookInventory).
2024-09-02 15:48:52.192 +02:00 [INF] Executed DbCommand (69ms) [Parameters=[@__ToLower_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[PasswordHash], [t].[PasswordResetToken], [t].[PasswordSalt], [t].[ResetTokenExpires], [t].[Username], [t0].[UserId], [t0].[RoleId], [t0].[Id], [t0].[Name]
FROM (
    SELECT TOP(1) [u].[Id], [u].[PasswordHash], [u].[PasswordResetToken], [u].[PasswordSalt], [u].[ResetTokenExpires], [u].[Username]
    FROM [Users] AS [u]
    WHERE LOWER([u].[Username]) = @__ToLower_0
) AS [t]
LEFT JOIN (
    SELECT [r].[UserId], [r].[RoleId], [r0].[Id], [r0].[Name]
    FROM [RoleUsers] AS [r]
    INNER JOIN [Roles] AS [r0] ON [r].[RoleId] = [r0].[Id]
) AS [t0] ON [t].[Id] = [t0].[UserId]
ORDER BY [t].[Id], [t0].[UserId], [t0].[RoleId]
2024-09-02 15:48:52.408 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__roleIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[PermissionId], [p].[Id], [p].[Name]
FROM [RolePermissions] AS [r]
INNER JOIN [Permissions] AS [p] ON [r].[PermissionId] = [p].[Id]
WHERE [r].[RoleId] IN (
    SELECT [r0].[value]
    FROM OPENJSON(@__roleIds_0) WITH ([value] int '$') AS [r0]
)
2024-09-02 15:48:52.466 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookInventory.DataAccessLayer.Entities.ServiceResponse`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-09-02 15:48:52.503 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory) in 2422.3215ms
2024-09-02 15:48:52.506 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.AuthsController.Login (BookInventory)'
2024-09-02 15:48:52.515 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7126/api/Auths/login - 200 798 application/json; charset=utf-8 2577.7372ms
2024-09-02 15:49:12.055 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/api/Authors/findById/1 - null null
2024-09-02 15:49:12.136 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.AuthorsController.GetAuthorById (BookInventory)'
2024-09-02 15:49:12.149 +02:00 [INF] Route matched with {action = "GetAuthorById", controller = "Authors"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAuthorById(Int32) on controller BookInventory.APIAccessLayer.Controllers.AuthorsController (BookInventory).
2024-09-02 15:49:12.160 +02:00 [INF] Displaying author with id 1!
2024-09-02 15:49:12.163 +02:00 [INF] Fetching the author with the id: 1
2024-09-02 15:49:12.210 +02:00 [INF] Executed DbCommand (17ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[DateOfBirth], [a].[EmailAddress], [a].[ImageUrl], [a].[Name], [a].[Nationality], [p].[Id], [p].[Address], [p].[AuthorId], [p].[Name], [p].[Website]
FROM [Authors] AS [a]
LEFT JOIN [Publishers] AS [p] ON [a].[Id] = [p].[AuthorId]
WHERE [a].[Id] = @__id_0
2024-09-02 15:49:12.239 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookInventory.LogicAcessLayer.Models.AuthorModels.AuthorGetModel'.
2024-09-02 15:49:12.248 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.AuthorsController.GetAuthorById (BookInventory) in 94.5707ms
2024-09-02 15:49:12.252 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.AuthorsController.GetAuthorById (BookInventory)'
2024-09-02 15:49:12.253 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/api/Authors/findById/1 - 200 147 application/json; charset=utf-8 198.5436ms
2024-09-02 15:49:16.929 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/1 - null null
2024-09-02 15:49:16.940 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:49:16.947 +02:00 [INF] Route matched with {action = "GetBooksByPublicationYear", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetBooksByPublicationYear(Int32) on controller BookInventory.APIAccessLayer.Controllers.BooksController (BookInventory).
2024-09-02 15:49:16.952 +02:00 [INF] API call to get books by publication year: 1.
2024-09-02 15:49:16.954 +02:00 [INF] Fetching books filtered by publication year from the database.
2024-09-02 15:49:17.027 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__publicationYear_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[Id], [b].[AuthorId], [b].[Edition], [b].[Format], [b].[Genres], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublicationYear], [b].[Stock], [b].[Title], [a].[Id], [a].[DateOfBirth], [a].[EmailAddress], [a].[ImageUrl], [a].[Name], [a].[Nationality]
FROM [Books] AS [b]
INNER JOIN [Authors] AS [a] ON [b].[AuthorId] = [a].[Id]
WHERE [b].[PublicationYear] = @__publicationYear_0
2024-09-02 15:49:17.048 +02:00 [INF] Exiting GetBooksByPublicationYear method with 0 books fetched.
2024-09-02 15:49:17.051 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookInventory.LogicAcessLayer.Models.BookModels.BookGetModel, BookInventory, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-02 15:49:17.059 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory) in 109.4312ms
2024-09-02 15:49:17.063 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:49:17.065 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/1 - 200 2 application/json; charset=utf-8 135.3475ms
2024-09-02 15:52:31.654 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/api/Books/getSingleBook/55 - null null
2024-09-02 15:52:31.696 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetSingleBook (BookInventory)'
2024-09-02 15:52:31.703 +02:00 [INF] Route matched with {action = "GetSingleBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSingleBook(Int32) on controller BookInventory.APIAccessLayer.Controllers.BooksController (BookInventory).
2024-09-02 15:52:31.706 +02:00 [INF] API call to get book with ID 55.
2024-09-02 15:52:31.708 +02:00 [INF] Fetching book with ID 55 from the database.
2024-09-02 15:52:31.724 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AuthorId], [b].[Edition], [b].[Format], [b].[Genres], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublicationYear], [b].[Stock], [b].[Title], [a].[Id], [a].[DateOfBirth], [a].[EmailAddress], [a].[ImageUrl], [a].[Name], [a].[Nationality]
FROM [Books] AS [b]
INNER JOIN [Authors] AS [a] ON [b].[AuthorId] = [a].[Id]
WHERE [b].[Id] = @__id_0
2024-09-02 15:52:31.727 +02:00 [WRN] Book with ID 55 not found.
2024-09-02 15:52:31.873 +02:00 [WRN] Book with ID 55 not found.
2024-09-02 15:52:31.875 +02:00 [INF] Executing NotFoundObjectResult, writing value of type 'System.String'.
2024-09-02 15:52:31.876 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.BooksController.GetSingleBook (BookInventory) in 171.3972ms
2024-09-02 15:52:31.888 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetSingleBook (BookInventory)'
2024-09-02 15:52:31.889 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/api/Books/getSingleBook/55 - 404 null text/plain; charset=utf-8 235.7423ms
2024-09-02 15:54:06.753 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/666666 - null null
2024-09-02 15:54:06.760 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:54:06.763 +02:00 [INF] Route matched with {action = "GetBooksByPublicationYear", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetBooksByPublicationYear(Int32) on controller BookInventory.APIAccessLayer.Controllers.BooksController (BookInventory).
2024-09-02 15:54:06.770 +02:00 [INF] API call to get books by publication year: 666666.
2024-09-02 15:54:06.773 +02:00 [INF] Fetching books filtered by publication year from the database.
2024-09-02 15:54:06.783 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__publicationYear_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[Id], [b].[AuthorId], [b].[Edition], [b].[Format], [b].[Genres], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublicationYear], [b].[Stock], [b].[Title], [a].[Id], [a].[DateOfBirth], [a].[EmailAddress], [a].[ImageUrl], [a].[Name], [a].[Nationality]
FROM [Books] AS [b]
INNER JOIN [Authors] AS [a] ON [b].[AuthorId] = [a].[Id]
WHERE [b].[PublicationYear] = @__publicationYear_0
2024-09-02 15:54:06.787 +02:00 [INF] Exiting GetBooksByPublicationYear method with 0 books fetched.
2024-09-02 15:54:06.788 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookInventory.LogicAcessLayer.Models.BookModels.BookGetModel, BookInventory, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-02 15:54:06.790 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory) in 22.3991ms
2024-09-02 15:54:06.795 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:54:06.800 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/666666 - 200 2 application/json; charset=utf-8 48.328ms
2024-09-02 15:54:13.128 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/2015 - null null
2024-09-02 15:54:13.146 +02:00 [INF] Executing endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:54:13.157 +02:00 [INF] Route matched with {action = "GetBooksByPublicationYear", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetBooksByPublicationYear(Int32) on controller BookInventory.APIAccessLayer.Controllers.BooksController (BookInventory).
2024-09-02 15:54:13.161 +02:00 [INF] API call to get books by publication year: 2015.
2024-09-02 15:54:13.165 +02:00 [INF] Fetching books filtered by publication year from the database.
2024-09-02 15:54:13.179 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__publicationYear_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[Id], [b].[AuthorId], [b].[Edition], [b].[Format], [b].[Genres], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublicationYear], [b].[Stock], [b].[Title], [a].[Id], [a].[DateOfBirth], [a].[EmailAddress], [a].[ImageUrl], [a].[Name], [a].[Nationality]
FROM [Books] AS [b]
INNER JOIN [Authors] AS [a] ON [b].[AuthorId] = [a].[Id]
WHERE [b].[PublicationYear] = @__publicationYear_0
2024-09-02 15:54:13.212 +02:00 [INF] Exiting GetBooksByPublicationYear method with 2 books fetched.
2024-09-02 15:54:13.215 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookInventory.LogicAcessLayer.Models.BookModels.BookGetModel, BookInventory, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-02 15:54:13.222 +02:00 [INF] Executed action BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory) in 60.7208ms
2024-09-02 15:54:13.224 +02:00 [INF] Executed endpoint 'BookInventory.APIAccessLayer.Controllers.BooksController.GetBooksByPublicationYear (BookInventory)'
2024-09-02 15:54:13.226 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7126/api/Books/getBooksByPublicationYear/2015 - 200 692 application/json; charset=utf-8 98.8023ms
